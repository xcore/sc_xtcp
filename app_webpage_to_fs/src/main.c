// Copyright (c) 2011, XMOS Ltd., All rights reserved
// This software is freely distributable under a derivative of the
// University of Illinois/NCSA Open Source License posted in
// LICENSE.txt and at <http://github.xcore.com/>

/*===========================================================================
 Filename: main.c
 Project : webpage to c file system (ascii)
 Author  :
 Version :
 Purpose
 -----------------------------------------------------------------------------


 ===========================================================================*/

/*---------------------------------------------------------------------------
 include files
 ---------------------------------------------------------------------------*/
#include <platform.h>
#include <stdio.h>
#include <print.h>
#include <string.h>
#include <stdlib.h>

/*---------------------------------------------------------------------------
 constants
 ---------------------------------------------------------------------------*/

/*---------------------------------------------------------------------------
 ports and clocks
 ---------------------------------------------------------------------------*/

/*---------------------------------------------------------------------------
 typedefs
 ---------------------------------------------------------------------------*/

/*---------------------------------------------------------------------------
 global variables
 ---------------------------------------------------------------------------*/

/*---------------------------------------------------------------------------
 static variables
 ---------------------------------------------------------------------------*/

/*---------------------------------------------------------------------------
 prototypes
 ---------------------------------------------------------------------------*/

/*---------------------------------------------------------------------------
 implementation
 ---------------------------------------------------------------------------*/

/** =========================================================================
 *  main
 *
 **/
int main(void)
{
    FILE *f_webpage; // webpage file
    FILE *f_cfile; // fs file

    char c;

    // USER: change paths here:
    // Location of the webpage.html
    f_webpage
                    = fopen("<webpage_path>/s2e.html",
                            "r");
    // Location of the resulting .c file
    f_cfile
                    = fopen("<webpage_path>/wpage.c",
                            "w+");

    fprintf(f_cfile, "#include \"wpage.h\" \n");
    fprintf(f_cfile, "char page[] = {\"");

    while (!feof(f_webpage))
    {
        c = fgetc(f_webpage);

        if (c == '"')
        {
            fprintf(f_cfile, "\\\"");
        }
        else if (c == '\n')
        {
            fprintf(f_cfile, "\\n");
        }
        else
        {
            if(c != 'ÿ')
            {
                putc(c, f_cfile);
            }
        }
    } // while(!feof(f_webpage))

    fprintf(f_cfile, "\"};");

    fclose(f_webpage);
    fclose(f_cfile);
    return 0;
}

/*=========================================================================*/
